<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.502">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Virginia Beach Housing Study Update - 9&nbsp; Develop a City-managed Housing Trust Fund</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sp-vbda.html" rel="next">
<link href="./solutions-overview.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sp-htf.html">Strategic priorities</a></li><li class="breadcrumb-item"><a href="./sp-htf.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Develop a City-managed Housing Trust Fund</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Virginia Beach Housing Study Update</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/housingforwardva/virginia-beach" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./virginia-beach-housing-study-update.docx" title="Download Docx" class="quarto-navigation-tool px-1" aria-label="Download Docx"><i class="bi bi-file-word"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About this study</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./executive-summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Executive summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-methods-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data and methodological notes</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Data findings</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hh-trends.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Household trends</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./market.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Market dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./affordability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Housing affordability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Conclusions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Solutions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./current-efforts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Current housing efforts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Solutions overview</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Strategic priorities</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sp-htf.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Develop a City-managed Housing Trust Fund</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sp-vbda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Expand VBDA’s housing role</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sp-education.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Design housing education campaign</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Easy wins</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ew-haf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Create worker housing fund</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ew-clt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Leverage VSCLT</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Background work</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bw-mumi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Pursue innovative development models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bw-permits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Streamline permitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bw-advisory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Explore zoning advisory board</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a1-engagement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Public and expert engagement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a2-workforce.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Workforce housing affordability analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a3-noah.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Naturally occurring affordable housing analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#how-it-works" id="toc-how-it-works" class="nav-link active" data-scroll-target="#how-it-works"><span class="header-section-number">9.1</span> HOW IT WORKS</a></li>
  <li><a href="#how-to-do-it" id="toc-how-to-do-it" class="nav-link" data-scroll-target="#how-to-do-it"><span class="header-section-number">9.2</span> HOW TO DO IT</a></li>
  <li><a href="#who-does-what" id="toc-who-does-what" class="nav-link" data-scroll-target="#who-does-what"><span class="header-section-number">9.3</span> WHO DOES WHAT</a></li>
  <li><a href="#funding-scope" id="toc-funding-scope" class="nav-link" data-scroll-target="#funding-scope"><span class="header-section-number">9.4</span> FUNDING SCOPE</a></li>
  <li><a href="#potential-funding-sources" id="toc-potential-funding-sources" class="nav-link" data-scroll-target="#potential-funding-sources"><span class="header-section-number">9.5</span> POTENTIAL FUNDING SOURCES</a></li>
  <li><a href="#metrics-to-evaluate-success" id="toc-metrics-to-evaluate-success" class="nav-link" data-scroll-target="#metrics-to-evaluate-success"><span class="header-section-number">9.6</span> METRICS TO EVALUATE SUCCESS</a></li>
  <li><a href="#important-considerations" id="toc-important-considerations" class="nav-link" data-scroll-target="#important-considerations"><span class="header-section-number">9.7</span> IMPORTANT CONSIDERATIONS</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="header-section-number">9.8</span> EXAMPLES</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sp-htf.html">Strategic priorities</a></li><li class="breadcrumb-item"><a href="./sp-htf.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Develop a City-managed Housing Trust Fund</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Develop a City-managed Housing Trust Fund</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="strategic-priority-1" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="strategic-priority-1">STRATEGIC PRIORITY 1</h3>
</section>
<section id="develop-a-city-managed-housing-trust-fund" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="develop-a-city-managed-housing-trust-fund">Develop a City-managed Housing Trust Fund</h3>
<p>A major barrier to affordable housing production in Virginia Beach is a shortage of capital with limited regulatory hurdles. A Virginia Beach Housing Trust Fund (HTF) would create a pool of capital that provides gap funding for a wide range of affordable housing projects in the city, including both rental and homeownership.</p>
<p>Local HTFs aren’t new in Virginia. Other cities like Alexandria and Richmond use them to provide flexible and vital funding for affordable housing developments when federal and state resources fall short.</p>
<p>HTFs can be capitalized by both public and private sources. Funding is awarded through a competitive process to ensure that development is meeting the needs and standards of the community. A locality may provide both grants and loans with flexible terms.</p>
</section>
<section id="how-it-works" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="how-it-works"><span class="header-section-number">9.1</span> HOW IT WORKS</h2>
<p>To build a successful HTF, the City will need to decide how the fund will be funded, governed, and administered. Below are nine program design elements that describe the major components of HTF operations.</p>
<p><em>Legal structure</em></p>
<p>HTFs are chartered by local governments through an enabling ordinance or law. Establishing the fund’s specific legal structure sets a clear purpose for funds, assigns core responsibilities, and gives power to distribute funding.</p>
<p>There are several possible avenues for incorporating an HTF, including:</p>
<ul>
<li>Wholly operating as a local government program (most common)</li>
<li>Delegating authority to an existing or new quasi-public body, such as a housing authority or regional commission</li>
<li>Delegating authority to an existing or new nonprofit organization</li>
<li>Using a public-private hybrid model</li>
</ul>
<p>The most appropriate option for Virginia Beach will likely be to create an HTF as a program administered by the Department of Housing and Neighborhood Preservation.</p>
<p><em>Governance and oversight</em></p>
<p>In general, HTFs are either entirely or predominantly composed of public dollars. Therefore, HTFs require proper governance and oversight to set funding levels and priorities and to make award decisions. These actions should balance public transparency with efficiency.</p>
<p>Important governance and oversight-related decisions include:</p>
<ul>
<li>Choosing whether to assign fiduciary responsibility to an existing public body (e.g., the City Council), a new public body (e.g., appointed advisory board), or defining distinct roles for both</li>
<li>Creating regulations to conform to Virginia open meeting laws, as applicable</li>
<li>Establishing avenues for collecting and using public input</li>
<li>Determining processes for fiscal audits and other regular checks and balances to ensure public trust</li>
</ul>
<p>One option for Virginia Beach would be to use the existing Housing Advisory Board (HAB) as the body for working with staff to design the HTF and evaluate applications. The HAB could make non-binding award recommendations to the City Council, who would be responsible for final approvals.</p>
<p><em>Administration and overhead</em></p>
<p>While a legal structure provides a broad outline of how an HTF will function, the successful administration of an HTF requires capable staff and funding to operate and sustain the fund. Administrative staff is typically housed within a local government department, nonprofit organization, or a newly established entity.</p>
<p>Important administrative decisions include:</p>
<ul>
<li>How operations of the HTF governing body/bodies are supported</li>
<li>How overhead costs are estimated and covered</li>
<li>Who serves as day-to-day financial stewards of the HTF monies</li>
<li>Who accepts, reviews, and recommends applications for approval</li>
<li>Who monitors awardees for compliance and success</li>
</ul>
<p>If the HTF is housed within the city, department leaders and the City Council should determine the expected increase in staff workload to make appropriate investments in new positions.</p>
<p><em>Strategic partnerships</em></p>
<p>Successful HTFs aren’t developed and sustained within a bubble. Robust partnerships with housing organizations can facilitate a strong HTF that consistently meets the needs of clients served by the local affordable housing industry. These partnerships can lead to a steady and increasing applicant pool, resulting in higher standards through competition. Other important community organizations also have a vested interest in housing and can help strengthen HTFs with additional funding, complementary resources, and political support.</p>
<p>HTF stakeholders should conduct strategic outreach to:</p>
<ul>
<li>For-profit and nonprofit housing developers</li>
<li>Housing, homelessness, and other social service providers</li>
<li>Anchor institutions, including universities, major employers, and philanthropic foundations</li>
<li>Grassroots community groups and faith-based organizations</li>
<li>Related trade and advocacy associations, such as business leagues</li>
</ul>
<p><em>Funding amounts and sources</em></p>
<p>An HTF needs financial seeding to get off the ground, but long-term financial sustainability is just as important. HTFs require a dedicated revenue source that comes either from an annual budget appropriation or through a revenue source such as real estate transfer taxes or developer fees. Determining funding levels is contextual on community needs and requires an understanding of housing needs.</p>
<p>Important funding-related decisions include:</p>
<ul>
<li>Choosing whether to make annual appropriations through a regular budgeting process or to establish a dedicated source of funds</li>
<li>Confirming the initial funding level for the HTF</li>
<li>Identifying potential revenue sources (e.g., taxes and fees, interest, sale or lease of government property)</li>
<li>Determining funding levels through housing need assessments, housing provider surveys, or comparable program applications</li>
</ul>
<p>The potential funding section below has more specific information on funding sources for Virginia Beach to explore.</p>
<p><em>Types of housing activities funded</em></p>
<p>While many existing housing programs focus on a specific housing activity such as weatherization or new construction, HTFs can act more broadly depending on community priorities. The broad ability of HTFs to fund different activities can ensure that all aspects of a community’s housing needs are addressed, while also filling the void where other housing programs may fall short.</p>
<p>Possible uses for HTF funding include, but are not limited to:</p>
<ul>
<li>Equity to support the creation or preservation of affordable rental housing</li>
<li>Revolving low- or zero-interest loans to help finance affordable housing development</li>
<li>Land acquisition grants</li>
<li>Homebuyer assistance for down payments, closing costs, and other expenses</li>
<li>Rehabilitation, energy efficiency, and weatherization projects</li>
<li>Operational support for homelessness prevention and related services</li>
<li>Matching grants for CDBG, HOME, and other federal or state funds</li>
</ul>
<p><em>Income and household priorities</em></p>
<p>Communities can support their members most in need by setting income and household priorities. This allows for more flexibility and responsiveness than other state and federal programs can offer. Definitions for income ranges and households served are often defined in enabling legislation, but priorities may change over time to reflect a community’s evolving needs.</p>
<p>HTF resources can be prioritized in several ways:</p>
<ul>
<li>Targeting homeownership, rental, homelessness, or some combination of those needs</li>
<li>Focusing on new supply or improving/preserving existing housing stock</li>
<li>Concentrating on extremely or very low-income households, or promoting a broader range of affordability</li>
</ul>
<p>Based on the affordability analysis earlier in this report, Virginia Beach should likely focus its HTF on the creation of new rental homes affordable to households below 50% AMI. Additional priorities should include affordable senior housing and permanent supportive housing. These projects are some of the most difficult to successfully finance due to the additional investments needed per unit.</p>
<p><em>Award criteria and application scoring process</em></p>
<p>A structured application and scoring process for partners will ensure an efficient and transparent use of funds. HTF administrators are responsible for establishing this process, as well as developing criteria for potential applicants. A successful HTF is a two-way street and requires strong partners to make sure funds are used properly.</p>
<p>Relevant decisions to make for this program design element include:</p>
<ul>
<li>Determining who gets to establish criteria and how</li>
<li>Deciding whether criteria will be regularly re-evaluated with public feedback</li>
<li>Establishing minimum requirements for applicants (e.g., years incorporated, annual budget, legal status)</li>
<li>Choosing the application and award schedule (e.g., annual cycle, rolling basis)</li>
<li>Outlining the decision-making process from submission to final award</li>
</ul>
<p><em>Financial sustainability</em></p>
<p>Virginia Beach’s housing challenges were not created in the course of only a few years, so efforts to solve these problems will likewise take time. One major consideration for HTFs is how to maintain or increase funding beyond any initial startup investments.</p>
<p>Important actions to ensure fund sustainability include:</p>
<ul>
<li>If funding is allocated each year (i.e., no dedicated revenue), determining how to make it a consistent priority for policymakers</li>
<li>If there is a dedicated source of revenue, analyzing potential threats and challenges to those collection streams (e.g., if using a meals tax, what would happen in another pandemic?)</li>
<li>Investigating ways to diversify revenue sources, such as corporate and philanthropic gifts</li>
<li>Understanding the differences between and weighing costs/benefits for pure grants versus low-to-zero interest loans, which are paid back to the fund</li>
</ul>
<p>To maximize the City’s investments, designing the HTF as a revolving fund would likely be the most appropriate approach. The fund can provide working capital to affordable housing developers at rates well below market, paired with repayment schedules that allow the project to sustainably transition to permanent financing.</p>
</section>
<section id="how-to-do-it" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="how-to-do-it"><span class="header-section-number">9.2</span> HOW TO DO IT</h2>
<p><strong>Within 6 months:</strong></p>
<ul>
<li>Create a task force to guide the HTF’s design and creation. This group should pull from existing experts and leaders, especially the Housing Advisory Board and ideally one or two members of the City Council.</li>
<li>Design a curriculum to guide the task force throughout the HTF development process. The program design elements described above can be a starting point.</li>
<li>Determine a meeting schedule for the task force, along with clear plans for receiving input from other partners and the public.</li>
<li>Start the task force work on legal and governance decisions so that core design aspects are agreed upon early in the process.</li>
<li>Engage other localities with HTFs in Virginia (and elsewhere) to ask specific questions and learn from their successes or challenges.</li>
</ul>
<p><strong>Within 1 year:</strong></p>
<ul>
<li>Determine the level of support that is achievable with city general funds in the next two years.</li>
<li>Explore the potential for “dedicated” sources of revenue for the fund; consider administrative fees associated with real estate transactions.</li>
<li>Identify and recruit additional sources of capital—including participation from lending institutions, corporations, and charitable foundations.</li>
<li>Develop a set of ideal projects that the HTF may serve based on housing type (e.g., rental, homeownership, supportive housing) and client type (e.g., income level, age, household type)</li>
<li>Determine whether the program will provide loans, grants, or both and at what levels. Base this determination on the ideal projects served and their anticipated needs.</li>
<li>Convene potential HTF applicants for feedback and begin drafting application and scoring criteria.</li>
</ul>
<p><strong>Within 2 years:</strong></p>
<ul>
<li>Draft any and all necessary award documentation, including underwriting material and development agreements.</li>
<li>Make the first dedicated allocations into the HTF and establish a schedule for the first award cycle.</li>
<li>Launch the HTF and begin taking applications. If desired, conduct feedback sessions with interested applicants to answer questions and provide guidance on their submissions.</li>
<li>Proceed with the formal decision process and select projects to award. Execute contracts.</li>
<li>Track and monitor progress to ensure compliance; make modifications as needed.</li>
</ul>
</section>
<section id="who-does-what" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="who-does-what"><span class="header-section-number">9.3</span> WHO DOES WHAT</h2>
<p><strong>City staff:</strong> Help organize and support task force, (likely) serve as HTF administration to manage funds and process applications.</p>
<p><strong>HTF task force:</strong> Take lead role in designing HTF, liaison with the City Council and other partners, support staff with specific tasks.</p>
<p><strong>Housing Advisory Board (or similar entity):</strong> Assume permanent responsibility for overseeing HTF and reviewing applications with staff, make recommendations to the City Council.</p>
<p><strong>City Council:</strong> Participate in and oversee task force, make decisions about funding types and levels, evaluate and approve HTF award recommendations.</p>
</section>
<section id="funding-scope" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="funding-scope"><span class="header-section-number">9.4</span> FUNDING SCOPE</h2>
<ul>
<li>To have any significant impact, the initial HTF capitalization should be at least $1,000,000 per year. This level of funding would allow for a range of housing projects to be supported annually. Most HTFs in the state are capitalized at levels that meet or exceed this amount.</li>
<li>Based upon anticipated funding levels, the HTF should set production goals for a period of 3-5 years. Because developing and fully funding complex affordable housing projects (especially rental communities) can take lengthy periods of time, these projects will frequently carry over from one year to the next. The HTF should set goals for commitment as well as completion of housing units per year over a 3-5-year window.</li>
<li>The HTF will need to establish clear criteria for project readiness in order to avoid locking up funding for projects for a year or years before construction begins.</li>
<li>To support and build a pipeline, the HTF may wish to allocate some of its funding for predevelopment activities. These funds need to be flexible and forgivable in the event that a project does not move forward.</li>
</ul>
</section>
<section id="potential-funding-sources" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="potential-funding-sources"><span class="header-section-number">9.5</span> POTENTIAL FUNDING SOURCES</h2>
<p><strong>Low barrier options:</strong></p>
<p>To get the HTF started—while longer-term solutions are explored—Virginia Beach can consider both general funds and its existing allocation of federal housing and community development dollars. These two sources are the most common options found in HTFs throughout Virginia.</p>
<p><em>General fund appropriation</em></p>
<p>General funds are used by nearly every HTF in the commonwealth, usually to supplement other sources. However, they can be an important starting point, since the City Council has full authority to allocate these dollars within the context of annual budget planning. While this flexibility is desirable, it also means that funds are at risk of disappearing should non-dedicated revenues decline and/or City funding priorities change.</p>
<p><em>Federal funds</em></p>
<p>Several localities in Virginia also include CDBG, HOME, and other federal housing grants in their HTFs. These funds are more reliable than general funds but are subject to program requirements outside City control. They are also not “new” funds—the Department of Housing and Neighborhood Preservation already distributes these grants each year. Therefore, the main purpose of including federal funds in HTFs is to consolidate application processes for a streamlined funding system.</p>
<p><strong>Dedicated sources:</strong></p>
<p>Dedicated revenue sources are a prerequisite for successful HTFs. These sources typically rely on a special tax or fee created specifically to fund housing investments. This stability is highly desirable, but must be planned with respect to a locality’s overall fiscal position—alongside more challenging political barriers as well.</p>
<p><em>“Penny” (or more) on real estate tax</em></p>
<p>One of the most common dedicated sources of revenue for HTFs is a supplemental assessment on local real estate taxes. This is often an additional $0.01 collected per $100, on top of the base real estate tax rate. Based on projections in the <a href="https://s3.us-east-1.amazonaws.com/virginia-beach-departments-docs/budget/Budget/Proposed/FY24-Proposed-Operating-Budget.pdf">proposed FY 2023-2024 operating budget</a>, an additional cent on the real estate tax in Virginia Beach would generate over $7,000,000.</p>
<p><em>New development extractions</em></p>
<p>Several localities in Virginia use new residential development (or other types of development) to help fund their HTFs. Incorporating “in lieu fees” as an option for the city’s Workforce Housing Program would likely be the most consistently effective mechanism, in addition to avoiding legal challenges. To receive a density bonus, developers could provide a financial contribution to the HTF as an alternative to providing on-site affordable units. Alexandria currently uses this as a successful revenue source. However, this option hinges on the Workforce Housing Program being widely adopted by new residential development across the city.</p>
<p>Alternatively, Virginia Beach may pursue voluntary “<a href="https://nvaha.org/wp-content/uploads/NVAH_1311_CommImpactRpt-WEB.pdf">linkage fees</a>” for commercial development. These fees are always negotiated on a project basis. For example, Fairfax County recommends a $3.00-per-square-foot surcharge for commercial development in Tysons Corner. The proceeds support the development of affordable and workforce housing in Tysons.</p>
<p><em>Transactional fees</em></p>
<p>While special taxes or fees on certain purchases and other economic activity are frequently used to fund HTFs, non-housing uses are more common. Examples include real estate transfer taxes, meals taxes, and hotel taxes. These options may be more palatable than a real estate tax increase but are usually more sensitive to volatile economic conditions. Virginia Beach should evaluate its current array of targeted taxes to determine the best opportunities for capturing additional revenue for housing.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Special Revenue Funds
</div>
</div>
<div class="callout-body-container callout-body">
<p>Virginia Beach already has several Special Revenue Funds (SRF) that connect specific income streams with specific uses.</p>
<ul>
<li><strong>Parks and Recreation Special Revenue Fund:</strong> Collected from user fees and a portion of real estate taxes. Estimated to be over $32,000,000 in FY 2023-2024.</li>
<li><strong>Tourism Investment Program Fund:</strong> Collected from 5% of the hotel tax, half the $2.00 Hotel Flat Tax, 1.06% of the meals tax, $0.05 per pack of the cigarette tax, and all the amusement tax. Estimated to be over $61,000,000 in FY 2023-2024.</li>
</ul>
</div>
</div>
<p><strong>High-impact solutions:</strong></p>
<p>Transformational investments in affordable housing are usually debt-financed. While still uncommon in Virginia, bonds specifically for housing are increasingly being issued by local governments in other states. This option may not be appropriate for Virginia Beach in the near future, so the City should also investigate an alternative approach newly authorized by state law.</p>
<p><em>Virginia Resources Authority</em></p>
<p>In 2023, the General Assembly adopted HB1805/SB1401, which adds affordable housing to the list of projects eligible to be financed by the Virginia Resources Authority (VRA). For localities with high bond ratings (such as Virginia Beach), municipal bonds issued by VRA have no impact on bond capacity.</p>
<p>Virginia Beach has previously partnered with VRA to finance $6,000,000 for the <a href="https://www.virginiaresources.gov/portfolio/projects/11/land-conservation-in-virginia-beach">Lynnhaven Oyster Restoration and Estuary Protection project</a>. While VRA is still evaluating how to support activities that support affordable housing as of October 2023, officials recommend that any interested locality proactively contact them to explore options.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p><em>General obligation bonds</em></p>
<p>Should Virginia Beach’s future fiscal priorities present the opportunity, the City can explore issuing its own general obligation (GO) bonds to raise capital for the HTF.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Using GO bonds
</div>
</div>
<div class="callout-body-container callout-body">
<p>Because GO bonds are secured by general revenue and not a specific income stream (e.g., public utility service fees), orienting a portion of the city’s tax-supported debt to a new priority is a major long-term strategic decision. Housing needs should be evaluated against concurrent public investment needs, such as hard infrastructure and school facilities, and incorporated into the city’s debt management policy and capital improvement plan (CIP) accordingly.</p>
</div>
</div>
<p>Historically, Charlottesville, Harrisonburg, and Alexandria have been the <a href="https://dmz1.dhcd.virginia.gov/HB854/part-5-bondfinancing.html#local-bond-options">only Virginia localities</a> to use GO bonds for housing. However, Richmond <a href="https://drive.google.com/file/d/1VFbPnG929ovCbz4NyEcBVRfFNhxWkIaX/view?usp=sharing">recently committed</a> $50,000,000 in bond revenue over five years to accelerate affordable housing production. LISC has also partnered with the city to leverage an additional $50,000,000.</p>
<p><em>Private and philanthropic support</em></p>
<p>A wide range of nonpublic funding sources support affordable housing. These include banks and other financial institutions that provide low-cost loans and grants, as well as investments by corporations and philanthropic foundations. More recently, community anchor institutions (including hospital systems, colleges and universities, and churches) are also finding ways to support affordable housing through monetary gifts and land donations.</p>
<p>However, private sources are rarely “mixed” into publicly operated HTFs, and instead serve as separate complements. HTFs that are managed by quasi-public or nonprofit organizations can more easily blend public and private dollars into a single fund, but these cases are rare.</p>
<p>Therefore, should Virginia Beach’s HTF be operated in full by the City, private and philanthropic sources can augment these efforts by:</p>
<ul>
<li>Providing matches to public investments, especially to cover discrete activities (e.g., site planning, community amenities, support services)</li>
<li>Funding experimental approaches and pilot projects (e.g., innovative construction methods)</li>
<li>Proactively designing special low-interest loans and lines of credit that easily pair with HTF awards</li>
</ul>
</section>
<section id="metrics-to-evaluate-success" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="metrics-to-evaluate-success"><span class="header-section-number">9.6</span> METRICS TO EVALUATE SUCCESS</h2>
<p>The success of an HTF can be measured by both what it does (outputs) and what impact it’s able to have (outcomes). Outputs refer to the tangible deliverables and activities generated by the HTF, while outcomes capture the broader impact and effectiveness of the fund. Importantly, outcomes can help determine whether the HTF is effectively addressing the priority challenges it was designed to address.</p>
<p>Below are suggested examples to measure both.</p>
<p><strong>Outputs:</strong></p>
<ul>
<li>Number of housing units created or preserved</li>
<li>Locations of homes across city</li>
<li>Cost metrics (e.g., per-unit subsidy, total development costs)</li>
<li>Funding leveraged</li>
<li>Time to completion and occupancy</li>
</ul>
<p><strong>Outcomes:</strong></p>
<ul>
<li>Beneficiary demographics</li>
<li>Affordability levels (e.g., resident cost burdens, costs relative to market average)</li>
<li>Economic impact</li>
<li>Quality-of-life (e.g., access to jobs, transportation)</li>
<li>Sustainability (HTF performance and ROI)</li>
<li>Partner satisfaction (surveys and feedback from stakeholders)</li>
</ul>
</section>
<section id="important-considerations" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="important-considerations"><span class="header-section-number">9.7</span> IMPORTANT CONSIDERATIONS</h2>
<ul>
<li>Staff should conduct an assessment of new legal and financial liabilities that accrue from administering funds from new sources—including local governments, banks, corporations, and charitable institutions. When funds are provided to the HTF from any of these sources in the form of grants, the HTF should have a standard set of requirements outlined in the grant agreement, including clarity around procedures and reporting for liability, lending, and grant making.</li>
<li>Staff should evaluate the capacity to undertake traditional bank style “underwriting” if HTF awards are structured as loans. Additional training may be needed, as well as potential upgrades to accounting programs and other software.</li>
<li>If some tasks are too burdensome for staff, a qualified third party could be hired to conduct underwriting, service loans, process payments, and other related duties. It is possible to outsource these functions to a community lending institution or to Virginia Community Capital, Virginia’s statewide community development financial institution (CDFI).</li>
</ul>
</section>
<section id="examples" class="level2" data-number="9.8">
<h2 data-number="9.8" class="anchored" data-anchor-id="examples"><span class="header-section-number">9.8</span> EXAMPLES</h2>
<p><strong><a href="https://nrvrc.org/nrv-housing-trust-fund">New River Valley Housing Trust Fund</a></strong></p>
<ul>
<li>Brand-new and seeded with a Virginia Housing PDC grant</li>
<li>Regional oversight board (appointed by New River Valley Regional Commission) will help staff evaluate proposals; final approval by NRVRC Board</li>
</ul>
<p><strong><a href="https://www.arlingtonva.us/Government/Programs/Housing/Development/Affordable-Housing-Investment-Fund">Arlington Affordable Housing Investment Fund</a></strong></p>
<ul>
<li>Mix of dedicated county revenue sources (e.g.&nbsp;recordation tax) and traditional federal funds</li>
<li>Led by staff; awards are officially approved through advisory committee and board of supervisors</li>
</ul>
<p><strong><a href="https://media.alexandriava.gov/docs-archives/housing/info/2020=hofapplicationprocessrequirements.pdf">Alexandria Housing Opportunities Fund</a></strong></p>
<ul>
<li>Funded by developer payments (in lieu of providing affordable units), 1 cent real estate tax, and 1% increment of meals tax</li>
<li>Led by staff; awards are officially approved through advisory committee and board of supervisors</li>
</ul>


</section>
<aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Based on interview with Shawn Crumlish, Executive Director of the Virginia Resource Authority, August 2023.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</aside>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./solutions-overview.html" class="pagination-link  aria-label=" &lt;span="" overview&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Solutions overview</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sp-vbda.html" class="pagination-link" aria-label="<span class='chapter-number'>10</span>&nbsp; <span class='chapter-title'>Expand VBDA's housing role</span>">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Expand VBDA’s housing role</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>